<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../../../img/favicon.ico">
  <title>Wall Follower - BWSI RACECAR</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Wall Follower";
    var mkdocs_page_input_path = "curriculum/mod1/02_wall_follower/wall_follower.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../../.." class="icon icon-home"> BWSI RACECAR</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../../../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Introduction</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../../intro/overview/">Course Overview</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Curriculum</span>
    <ul class="subnav">
                <li class="">
                    
    <span class="caption-text">Module 0: Getting Started</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../../mod0/01_hardware_intro/hardware_intro/">Using the Hardware</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../mod0/02_ros_intro/ros_intro/">Intro to Terminal & ROS</a>
                </li>
    </ul>
                </li>
                <li class=" current">
                    
    <span class="caption-text">Module 1: Basic Control</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../01_proportional_controller/proportional_controller/">Proportional Control</a>
                </li>
                <li class="toctree-l3 current">
                    
    <a class="current" href="./">Wall Follower</a>
    <ul class="subnav">
            
    <li class="toctree-l4"><a href="#competitive-lab-wall-following-drag-race">Competitive Lab: Wall Following Drag Race</a></li>
    
        <ul>
        
            <li><a class="toctree-l5" href="#problem-statement">Problem Statement</a></li>
        
            <li><a class="toctree-l5" href="#idea-behind-the-algorithm">Idea Behind the Algorithm</a></li>
        
            <li><a class="toctree-l5" href="#implementation">Implementation</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../03_safety_controller/safety_controller/">Safety Controller</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../04_potential_fields/potential_fields/">Potential Fields Controller</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Module 2: Computer Vision</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../../mod2/01_segmentation/segmentation/">Color Segmentation</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../mod2/02_line_follow/line_follow/">Line Following</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../mod2/03_feature_detect/feature_detect/">Feature Detection</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Module 3: Detecting Environments</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../../mod3/01_ar_sounds/ar_sounds/">AR Tags & Sounds</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../mod3/02_maps_bags/maps_bags/">Maps & Rosbags</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Module 4: Machine Learning</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../../mod4/01_hog_svm/hog_svm_lab/">HOG SVM</a>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Cheatsheets</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../../cheatsheets/python/">Python</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../../cheatsheets/opencv/">OpenCV</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../../cheatsheets/ros/">ROS Terminal Commands</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../../cheatsheets/ros-topics-msgs/">ROS Topics and Messages</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Setup</span>
    <ul class="subnav">
                <li class="">
                    
    <span class="caption-text">Hardware</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../../../setup/hardware/build/">Build</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../../setup/hardware/router/">Router</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Software</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../../../setup/software/jetson/">Jetson Config</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../../setup/software/native_ros_install/native_ros_install_ref/">Native ROS Install</a>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">References</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../../references/ros/ros_ref/">ROS</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../../references/cartographer/cartographer_ref/">Cartographer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../../references/localization/localization_ref/">Localization</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../../references/lidar/">Lidar</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../../references/zed/">ZED</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../../references/speakers/sound/">Speakers</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../../references/rosbag/rosbag_ref/">Rosbags</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../../references/docker/docker_ref/">Docker</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../../references/collab/collab_ref/">Collaboration</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Resources</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../../resources/faq/">FAQ</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../../resources/contributors/">Contributors</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../..">BWSI RACECAR</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../..">Docs</a> &raquo;</li>
    
      
        
          <li>Module 1: Basic Control &raquo;</li>
        
      
        
          <li>Curriculum &raquo;</li>
        
      
    
    <li>Wall Follower</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p><center></p>
<h1 id="competitive-lab-wall-following-drag-race">Competitive Lab: Wall Following Drag Race</h1>
<p>Vroom Vroom
</center>
<hr/></p>
<h2 id="problem-statement">Problem Statement</h2>
<p>It's time for your first challenge! You will navigate a racetrack using wall following. We will have two cars running simultaneously between two walls with "lanes" made of tape:
<center>
<img alt="" src="../../Resources/DragRaceTrack.jpg" />
</center>
We will time each team, and if you stray outside of your lane, you will get a time penalty (the lanes are about 3 cars wide, so it won't hopefully won't be too difficult).</p>
<h2 id="idea-behind-the-algorithm">Idea Behind the Algorithm</h2>
<p>Wall following is a fairly simple mode of autonomous navigation where your car will drive alongside a wall. There are multiple ways to do this. The simplest way would be to keep the car a certain distance from an obstacle to the side of the car (using a proportional or PID controller).
<center>
<img alt="" src="../../Resources/WallFollowingProportional.png" />
</center></p>
<p>Another strategy is to first find what is most likely to be a wall, then use it to predict the path of the wall. You could try to do a full linear regression, but this probably isn't the most efficient method. You can also do a simple "bang-bang" method and pick two random close points that seem to represent a wall, then have the car follow the line that passes through them. 
<center>
<img alt="" src="../../Resources/WallFollowing.jpg" />
</center></p>
<h2 id="implementation">Implementation</h2>
<p>Here are some tips for a successful wall follower:</p>
<ul>
<li>Consider slicing the <code>ranges</code> data into more useful pieces. A majority of the data won’t be useful to you if you only care about a wall to one side. When you can, try to use <a href="https://docs.scipy.org/doc/numpy-dev/user/quickstart.html"><code>numpy</code></a> operations rather than for loops in your code. <a href="https://docs.scipy.org/doc/numpy-1.13.0/reference/arrays.indexing.html">Multidimensional slicing</a> and <a href="https://docs.scipy.org/doc/numpy-1.13.0/user/basics.broadcasting.html">broadcasting</a> can make your code cleaner and much more efficient. You can turn any array into a <code>numpy</code> array with <a href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.array.html"><code>np.array</code></a>, or you can integrate it directly with ROS like in <a href="http://wiki.ros.org/rospy_tutorials/Tutorials/numpy">this tutorial</a>.</li>
<li>Start off just looking for a wall on one side of the car; once this side works, implement it for the other side as well. You can map the left and right walls to different button (ex. 'A' activates the left wall follower, and 'B' activates the right wall follower). All the joystick buttons correspond to an integer in its ROS message; check the joystick callback function or run <code>rostopic echo vesc/joy</code> for hints on how to map buttons. </li>
<li>Convert LIDAR points to cartesian points to calculate their resulting line. Make a separate function to do this.</li>
<li>Be warned that if your algorithm only tries to make the car parallel to the wall, the car's average distance from the wall may develop cumulative error.</li>
</ul>
<p><strong>Extra Challenges</strong>: Make the car autonomously decide which wall it should follow. You might base this off of factors like the distance or the accuracy of the predicted wall. If you also complete this, you could try to make your wall follower more robust, or try to implement a <a href="https://en.wikipedia.org/wiki/PID_controller">PID</a> to make it smoother and more accurate.</p>
<p>To keep your code organized and efficient, we've set up empty functions for you. I recommend only using <code>drive_callback</code> to set the driving speed and angle and putting everything else in other function. If there is too much code in a callback, it will become too slow and the car won't drive smoothly.</p>
<p>Functions to write:</p>
<ul>
<li><code>convertPoint</code>: convert polar points (points with only magnitude and angle) to cartesian coordinates</li>
<li><code>estimateWall</code>: Predict the wall using the method described above. Currently, it takes in a direction (left or right) as a parameter, but you can change this if you'd like</li>
<li><code>chooseWall</code>: Autonomously choose which wall to follow (this can be left empty if you don't get to it)</li>
</ul>
<p>As always, start off by testing your code with the simulator before trying out the car itself.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../03_safety_controller/safety_controller/" class="btn btn-neutral float-right" title="Safety Controller">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../01_proportional_controller/proportional_controller/" class="btn btn-neutral" title="Proportional Control"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../../01_proportional_controller/proportional_controller/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../03_safety_controller/safety_controller/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../../../..';</script>
    <script src="../../../../js/theme.js" defer></script>
      <script src="../../../../search/main.js" defer></script>

</body>
</html>
