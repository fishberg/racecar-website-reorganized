<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../../../img/favicon.ico">
  <title>Proportional Control - BWSI RACECAR</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Proportional Control";
    var mkdocs_page_input_path = "curriculum/mod1/01_proportional_controller/proportional_controller.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../../.." class="icon icon-home"> BWSI RACECAR</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../../../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Introduction</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../../intro/overview/">Course Overview</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Curriculum</span>
    <ul class="subnav">
                <li class="">
                    
    <span class="caption-text">Module 0: Getting Started</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../../mod0/01_hardware_intro/hardware_intro/">Using the Hardware</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../mod0/02_ros_intro/ros_intro/">Intro to Terminal & ROS</a>
                </li>
    </ul>
                </li>
                <li class=" current">
                    
    <span class="caption-text">Module 1: Basic Control</span>
    <ul class="subnav">
                <li class="toctree-l3 current">
                    
    <a class="current" href="./">Proportional Control</a>
    <ul class="subnav">
            
    <li class="toctree-l4"><a href="#probem-statement">Probem Statement</a></li>
    

    <li class="toctree-l4"><a href="#idea-behind-the-algorithm">Idea Behind the Algorithm</a></li>
    

    <li class="toctree-l4"><a href="#implementation">Implementation</a></li>
    

    </ul>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../02_wall_follower/wall_follower/">Wall Follower</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../03_safety_controller/safety_controller/">Safety Controller</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../04_potential_fields/potential_fields/">Potential Fields Controller</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Module 2: Computer Vision</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../../mod2/01_segmentation/segmentation/">Color Segmentation</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../mod2/02_line_follow/line_follow/">Line Following</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../mod2/03_feature_detect/feature_detect/">Feature Detection</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Module 3: Detecting Environments</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../../mod3/01_ar_sounds/ar_sounds/">AR Tags & Sounds</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../mod3/02_maps_bags/maps_bags/">Maps & Rosbags</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Module 4: Machine Learning</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../../mod4/01_hog_svm/hog_svm_lab/">HOG SVM</a>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Cheatsheets</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../../cheatsheets/python/">Python</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../../cheatsheets/opencv/">OpenCV</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../../cheatsheets/ros/">ROS Terminal Commands</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../../cheatsheets/ros-topics-msgs/">ROS Topics and Messages</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Setup</span>
    <ul class="subnav">
                <li class="">
                    
    <span class="caption-text">Hardware</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../../../setup/hardware/build/">Build</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../../setup/hardware/router/">Router</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Software</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../../../setup/software/jetson/">Jetson Config</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../../setup/software/native_ros_install/native_ros_install_ref/">Native ROS Install</a>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">References</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../../references/ros/ros_ref/">ROS</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../../references/cartographer/cartographer_ref/">Cartographer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../../references/localization/localization_ref/">Localization</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../../references/lidar/">Lidar</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../../references/zed/">ZED</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../../references/speakers/sound/">Speakers</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../../references/rosbag/rosbag_ref/">Rosbags</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../../references/docker/docker_ref/">Docker</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../../references/collab/collab_ref/">Collaboration</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Resources</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../../resources/faq/">FAQ</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../../resources/contributors/">Contributors</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../..">BWSI RACECAR</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../..">Docs</a> &raquo;</li>
    
      
        
          <li>Module 1: Basic Control &raquo;</li>
        
      
        
          <li>Curriculum &raquo;</li>
        
      
    
    <li>Proportional Control</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p><center>
<h1>Lab: Proportional Control</h1>
Let's make the car autonomously react to its environment!
</center>
<hr/></p>
<h2 id="probem-statement">Probem Statement</h2>
<p>The racecar's goal will be to maintain a certain distance away from an object in front of it. We will use proportional control to implement this behavior.</p>
<p><center>
<img alt="" src="../../Resources/ProportionalControl.gif" />
</center></p>
<h2 id="idea-behind-the-algorithm">Idea Behind the Algorithm</h2>
<p>A simple, non-propotional way to implement the behavior would be (pardon the pythonic pseudocode):</p>
<pre><code>    if (distance&gt;desired):
        motor_power(1)
    else:
        motor_power(-1)
</code></pre>

<p>This is a bang-bang controller. It would work, but not efficiently. It tries to run at constant speeds, so even if the speed is reasonable (even a tad slow) when the car is driving normally, the car would really jerk around when switches directions. (Don't believe us? Try it out.) </p>
<p>So what could we do to improve this controller? We could add a greater variety of speeds:</p>
<pre><code class="python">    if (distance&gt;desired+10):
        motor_power(2)
    elif (disance&gt;desired+5):
        motor_power(1)
    elif (distance&gt;desired+1):
        motor_power(0.2)
    elif (distance&lt;desired-10):
        motor_power(-2)
    elif (distance&lt;desired-5):
        motor_power(-1)
    elif (distance&lt;desired-1):
        motor_power(-0.2)
    else:
        motor_power(0)
</code></pre>

<p>In this model, when the car is far away, from the desired distance, it can run at a fast speed of 2, but as it gets closer to the desired distance, it slows down to 1, then 0.2, and finally switches direction at 0.</p>
<p>This is an improvement. But we could improve it even more by making continuous changes as opposed to these discrete bang-bang steps.<br>
<strong><font color="00AA00">Your goal is to make the speed directly proportional to distance away (or the "error") from the desired distance.</font></strong></p>
<h2 id="implementation">Implementation</h2>
<p>Choose a distance threshold, probably between 0.5 and 1.5 meters. Have the car aim to stay this distance away from an object in front of it. Of course, this will only allow the car to follow it in a straight line. If you have extra time, you can use this same idea to adjust the angle of the wheels so the car will stay squared to the object as it moves.</p>
<p>Work in <code>controller.py</code>. Instead of working in <code>drive_callback</code>, write a new function <code>propControl</code>, then publish in the callback.</p>
<p>If you have questions about getting distance measurements from the LIDAR, see the <a href="http://bwsi-racecar.com/racecar-parts/lidar/#usage-in-ros">Usage in ROS</a> section of the LIDAR reference page.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../02_wall_follower/wall_follower/" class="btn btn-neutral float-right" title="Wall Follower">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../../mod0/02_ros_intro/ros_intro/" class="btn btn-neutral" title="Intro to Terminal & ROS"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../../../mod0/02_ros_intro/ros_intro/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../02_wall_follower/wall_follower/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../../../..';</script>
    <script src="../../../../js/theme.js" defer></script>
      <script src="../../../../search/main.js" defer></script>

</body>
</html>
